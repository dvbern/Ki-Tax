<div class="gesuch-modul">
    <h1 class="access-for-all-title" translate>AFA_GESUCHSFORMULAR</h1>
    <div class="row view-title">
        <div class="col-md-12">
            <h2>
                <span *ngIf="hasMultipleFinSit" translate [translateParams]="{antragstellende: getGSName()}">EKVI_EINKOMMENSVERSCHLECHTERUNG_FUER_BASISJAHR</span>
                <span *ngIf="!hasMultipleFinSit" translate>EINKOMMENSVERSCHLECHTERUNG</span>
            </h2>
            <hr class="header"/>
        </div>
    </div>

    <ng-container *ngIf="isFinSitVollstaendigAusgefuellt; then finSitAusgefuellt else finSitNichtAusgefuellt"></ng-container>

    <ng-template #finSitNichtAusgefuellt>
        <div data-test="warnung-ekv-fin-sit-ausfuellen" class="well well-status-warten">
            <span translate>WARNUNG_FIN_SIT_AUSFUELLEN</span>
        </div>
    </ng-template>
    <ng-template #finSitAusgefuellt>
        <form #form="ngForm">

            <ng-container *ngIf="model.getFiSiConToWorkWith().finanzielleSituationJA.quellenbesteuert; then bruttolohnFragen else steuerveranlagFragen"></ng-container>
            <ng-template #steuerveranlagFragen>
                <dv-steuerveranlagt-schwyz [finSitJA]="model.getEkvToWorkWith()"
                                           [finSitGS]="model.getEkvToWorkWith_GS()"
                                           [readonly]="gesuchmodelManager.isGesuchReadonly()">
                </dv-steuerveranlagt-schwyz>
            </ng-template>
            <ng-template #bruttolohnFragen>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <dv-input-label-field
                                [name]="'bruttoLohn'"
                                [(model)]="model.getEkvToWorkWith().bruttolohnAbrechnung1"
                                [labelMessageKey]="'FINANZIELLE_SITUATION_BRUTTOLOHN'"
                                [inputRequired]="true"
                                [tooltipMessageKey]="'FINANZIELLE_SITUATION_BRUTTOLOHN_HINT'"
                                [showBisher]="isNotNullOrUndefined(model.getEkvToWorkWith_GS())"
                                [deklaration]="model.getEkvToWorkWith_GS()?.bruttolohnAbrechnung1"
                                [korrektur]="model.getEkvToWorkWith().bruttolohnAbrechnung1">
                            </dv-input-label-field>
                        </div>
                    </div>
                </div>

            </ng-template>
        </form>

        <dv-navigation-x (dvSave)="prepareSave($event.onResult)"
                         [dvNext]="true"
                         [dvPrevious]="true"
                         [dvSubStep]="3"></dv-navigation-x>
    </ng-template>

</div>

