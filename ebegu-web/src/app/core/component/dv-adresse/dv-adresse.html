<!--
  ~ Ki-Tax: System for the management of external childcare subsidies
  ~ Copyright (C) 2017 City of Bern Switzerland
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  ~ GNU Affero General Public License for more details.
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program. If not, see <http://www.gnu.org/licenses/>.
  -->

<!-- strasse/hausnummer -->
<div ng-form="adresseForm">
    <fieldset class="dv-adresse__fieldset">

        <!-- Adresse Organisation-->
        <div class="row" ng-if="vm.organisation">
            <div class="col-xs-12 dv-input-container-small">
                <dv-input-container class="form-group">
                    <label class="md-no-float" data-translate="ADRESSE_ORGANISATION" for="{{vm.prefix}}-organisation">
                    </label>
                    <input aria-describedby="{{vm.prefix}}-organisation-error" id="{{vm.prefix}}-organisation"
                           type="text" name="organisation"
                           ng-model="vm.getModel().adresseJA.organisation"
                           dv-max-length class="form-control">
                    <dv-bisher gs="vm.getModel().adresseGS.organisation"
                               ja="vm.getModel().adresseJA.organisation"
                               show-if-bisher-none="vm.showIfBisherNone !== false"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-organisation" for="adresseForm.organisation.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
        </div>

        <div class="dv-adresse row">
            <!--Strasse-->
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group">
                    <label class="md-no-float" data-translate="ADRESSE_STRASSE" for="{{vm.prefix}}-strasse">
                    </label>
                    <input aria-describedby="{{vm.prefix}}-strasse-error" id="{{vm.prefix}}-strasse" type="text" name="adresseStrasse"
                            ng-model="vm.getModel().adresseJA.strasse"
                           autocomplete="address-line1"
                           dv-max-length  maxlength="60" class="form-control" required>
                    <dv-bisher gs="vm.getModel().adresseGS.strasse"
                               ja="vm.getModel().adresseJA.strasse"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-strasse" for="adresseForm.adresseStrasse.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group secondColumn">
                    <label class="md-no-float" data-translate="ADRESSE_HAUSNUMMER" for="{{vm.prefix}}-hausnummer">
                    </label>
                    <input aria-describedby="{{vm.prefix}}-hausnummer-error" id="{{vm.prefix}}-hausnummer" type="text"
                           name="adresseHausnummer"   autocomplete="address-line2"
                           ng-model="vm.getModel().adresseJA.hausnummer"
                           dv-max-length dv-trim-empty class="form-control">
                    <dv-bisher gs="vm.getModel().adresseGS.hausnummer"
                               ja="vm.getModel().adresseJA.hausnummer"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-hausnummer" for="adresseForm.adresseHausnummer.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
        </div>
        <!-- Adresse Zusatz-->
        <div class="row">
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group">
                    <label class="md-no-float" data-translate="ADRESSE_ZUSATZZEILE" for="{{vm.prefix}}-zusatzzeile">
                    </label>
                    <input aria-describedby="{{vm.prefix}}-zusatzzeile-error" id="{{vm.prefix}}-zusatzzeile"
                           type="text" name="adresseZusatzzeile"
                           autocomplete="address-line3"
                           ng-model="vm.getModel().adresseJA.zusatzzeile"
                           dv-max-length class="form-control" dv-trim-empty>
                    <dv-bisher gs="vm.getModel().adresseGS.zusatzzeile"
                               ja="vm.getModel().adresseJA.zusatzzeile"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-zusatzzeile" for="adresseForm.adresseZusatzzeile.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
        </div>
        <!-- PLZ ORT-->
        <div class="row">
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group">
                    <label class="md-no-float" data-translate="ADRESSE_PLZ" for="{{vm.prefix}}-plz">
                    </label>
                    <input aria-describedby="{{vm.prefix}}-plz-error" id="{{vm.prefix}}-plz" type="text"
                           name="adressePlz" ng-model="vm.getModel().adresseJA.plz" autocomplete="postal-code"
                           dv-max-length class="form-control" required>
                    <dv-bisher gs="vm.getModel().adresseGS.plz"
                               ja="vm.getModel().adresseJA.plz"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-plz" for="adresseForm.adressePlz.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group secondColumn">
                    <label class="md-no-float" data-translate="ADRESSE_ORT" for="{{vm.prefix}}-ort">
                    </label>
                    <input aria-describedby="{{vm.prefix}}-ort-error" id="{{vm.prefix}}-ort" type="text"
                           name="adresseOrt" ng-model="vm.getModel().adresseJA.ort"
                           autocomplete="address-level3"
                           dv-max-length maxlength="40" class="form-control" required>
                    <dv-bisher gs="vm.getModel().adresseGS.ort"
                               ja="vm.getModel().adresseJA.ort"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-ort" for="adresseForm.adresseOrt.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
        </div>
        <!-- Gemeinde-->
        <div class="row" ng-if="false">
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group">
                    <label class="md-no-float" data-translate="ADRESSE_GEMEINDE" for="{{vm.prefix}}-gemeinde">
                    </label>
                    <input aria-describedby="{{vm.prefix}}-gemeinde-error" id="{{vm.prefix}}-gemeinde" type="text"
                           name="adresseGemeinde" ng-model="vm.getModel().adresseJA.gemeinde"
                           autocomplete="address-level2"
                           dv-max-length class="form-control">
                    <dv-bisher gs="vm.getModel().adresseGS.gemeinde"
                               ja="vm.getModel().adresseJA.gemeinde"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-gemeinde" for="adresseForm.adresseGemeinde.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
        </div>
        <!-- Land-->
        <div class="row">
            <div class="col-sm-12 dv-input-container-medium">
                <div class="form-group">
                    <label class="md-no-float required" data-translate="ADRESSE_LAND" for="{{vm.prefix}}-land">
                    </label>
                    <div class="dv-select-style">
                        <select aria-describedby="{{vm.prefix}}-land-error" name="adresseLand" id="{{vm.prefix}}-land"
                                ng-model="vm.getModel().adresseJA.land"
                                ng-options="land.code as land.name for land in vm.laenderList | orderBy: 'name'"
                                class="form-control"
                                autocomplete="country-name"
                                required>
                        </select>
                    </div>
                    <dv-bisher gs="vm.getModel().adresseGS.land"
                               ja="vm.getModel().adresseJA.land"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"
                               specific-bisher-text="vm.bisherLand"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-land" for="adresseForm.adresseLand.$error"
                                       class="error"></dv-error-messages>
                </div>
            </div>
        </div>

        <!-- nicht in Bern wohnhaft-->
        <div class="row" dv-show-element dv-show-allowed-roles="vm.TSRoleUtil.getAllRolesButGesuchsteller()"
             dv-show-expression="vm.showNichtInGemeinde===true">
            <div class="col-xs-12 dv-input-container-question">
                <div class="checkbox">
                    <md-checkbox ng-model="vm.getModel().adresseJA.nichtInGemeinde" name="nichtInGemeinde"
                                 aria-label="{{'NICHT_IN_BERN_WOHNHAFT'|translate}}"
                                 dv-enable-element
                                 dv-enable-allowed-roles="vm.TSRoleUtil.getAdministratorOrAmtRole()"
                                 dv-enable-expression="vm.enableNichtInGemeinde()">
                        <span data-translate="NICHT_IN_BERN_WOHNHAFT"></span>
                    </md-checkbox>
                    <dv-error-messages for="adresseForm.adresseNichtInGemeinde.$error"
                                       class="error"></dv-error-messages>
                </div>
            </div>
        </div>


        <!-- gueltig ab / gueltig bis -->
        <div class="row marginTop05" ng-if="vm.showDatumVon()">
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group">
                    <!--suppress XmlInvalidId -->
                    <label class="md-no-float" data-translate="ADRESSE_GUELTIGAB" for="{{vm.prefix}}-gueltigAb">
                    </label>
                    <dv-datepicker input-id="{{vm.prefix}}-gueltigAb" input-name="gueltigAb" name="gueltigAb"
                                   ng-model="vm.getModel().adresseJA.gueltigkeit.gueltigAb"
                                   class="input-element" ng-required="true"
                                   ng-attr-placeholder="{{'DATE_PLACEHOLDER' | translate}}">
                    </dv-datepicker>
                    <dv-bisher gs="vm.getModel().adresseGS.gueltigkeit.gueltigAb"
                               ja="vm.getModel().adresseJA.gueltigkeit.gueltigAb"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-gueltigAb" for="adresseForm.gueltigAb.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12 dv-input-container-small">
                <dv-input-container class="form-group secondColumn" ng-if="false">
                    <!--suppress XmlInvalidId -->
                    <label class="md-no-float" data-translate="ADRESSE_GUELTIGBIS" for="{{vm.prefix}}-gueltigBis">
                    </label>
                    <dv-datepicker input-id="{{vm.prefix}}-gueltigBis" input-name="gueltigBis" name="gueltigBis"
                                   ng-model="vm.getModel().adresseJA.gueltigkeit.gueltigBis" ng-required="true">
                    </dv-datepicker>
                    <dv-bisher gs="vm.getModel().adresseGS.gueltigkeit.gueltigBis"
                               ja="vm.getModel().adresseJA.gueltigkeit.gueltigBis"
                               show-if-bisher-none="vm.showIfBisherNone === true"
                               block-existed="!!vm.getModel().adresseGS"></dv-bisher>
                    <dv-error-messages input-id="{{vm.prefix}}-gueltigBis" for="adresseForm.gueltigBis.$error"
                                       class="error"></dv-error-messages>
                </dv-input-container>
            </div>
        </div>

    </fieldset>
</div>

