<!--
  ~ Copyright (C) 2019 DV Bern AG, Switzerland
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->

<div class="row">
    <div class="col-sm-12 mt-2">
        <dv-accordion class="konfigurationList" allow-multiple-sections="true">
            <ng-container *ngFor="let konf of konfigurationsListe; let i = index">
                <dv-accordion-tab [tabid]="i"
                                  *ngIf="konfigurationsListe[i].gesuchsperiode.gueltigkeit.gueltigBis.isAfter(fiAnmeldungenStartDatum)">
                    <tab-title>
                        <div class="message-header">
                            <p class="fa fa-angle-right"></p>
                            <span translate
                                  [translateParams]="{fromTo: konf.gesuchsperiodeName, status: konf.gesuchsperiodeStatusName}">
                                GEMEINDE_TAB_FI_GP_TITLE
                        </span>
                        </div>
                    </tab-title>
                    <tab-body>
                        <div class="row">
                            <!--                            readonly -->
                            <div *ngIf="!isKonfigurationEditable(konfigurationsListe[i])" class="col-sm-12">
                                <div *ngFor="let fiStammdaten of konfigurationsListe[i].ferieninselStammdaten" class="ferien">

                                    <div class="row">
                                        <div class="col-md-8">
                                            <b>
                                                <span>{{fiStammdaten.ferienname | translate}}</span>
                                            </b>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-8">
                                            <p>
                                                <span>{{'ANMELDESCHLUSS' | translate}}:&nbsp;{{formatDate(fiStammdaten.anmeldeschluss)}}</span>
                                            </p>
                                            <div>
                                                <span>Zeitr√§ume:</span>
                                                <ul>
                                                    <li *ngIf="fiStammdaten.ersterZeitraum?.id">
                                                        <span>{{formatDate(fiStammdaten.ersterZeitraum.gueltigkeit.gueltigAb)}}</span> -
                                                        <span>{{formatDate(fiStammdaten.ersterZeitraum.gueltigkeit.gueltigBis)}}</span>
                                                    </li>
                                                    <li *ngFor="let zeitraum of fiStammdaten.zeitraumList">
                                                        <span>{{formatDate(zeitraum.gueltigkeit.gueltigAb)}}</span> -
                                                        <span>{{formatDate(zeitraum.gueltigkeit.gueltigBis)}}</span>
                                                    </li>
                                                    <li *ngIf="!fiStammdaten.ersterZeitraum?.id">
                                                        <span>{{'KEINE_FERIENINSELZEITRAUME' | translate}}</span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <!--                            editable -->
                            <div *ngIf="isKonfigurationEditable(konfigurationsListe[i])" class="col-sm-12">
                                <div *ngFor="let fiStammdaten of konfigurationsListe[i].ferieninselStammdaten" class="ferien">

                                    <div class="row">
                                        <div class="col-md-8">
                                            <b>
                                                <span>{{fiStammdaten.ferienname | translate}}</span>
                                            </b>
                                        </div>
                                    </div>
                                    <!--                                   Titelzeile-->
                                    <div class="row">
                                        <div class="col-md-4">
                                            <span>{{'VON' | translate}}</span>
                                        </div>
                                        <div class="col-md-4">
                                            <span>{{'BIS' | translate}}</span>
                                        </div>
                                        <div class="col-md-4">
                                            <span>{{'ANMELDESCHLUSS' | translate}}</span>
                                        </div>
                                    </div>
                                    <div class="row zeitabschnitt">
                                        <div class="col-md-4">
                                            <input class="dv-mat-datepicker" type="text"
                                                   [name]="fiStammdaten + '_gueltigAb'" [id]="fiStammdaten + '_gueltigAb'"
                                                   [(ngModel)]="fiStammdaten.ersterZeitraum.gueltigkeit.gueltigAb"
                                                   [matDatepicker]="gueltigAb"
                                                   [placeholder]="'DATE_PLACEHOLDER' | translate"
                                                   [required]="isDatumAbRequired(fiStammdaten.ersterZeitraum, fiStammdaten)">
                                            <mat-datepicker-toggle matSuffix
                                                                   [for]="gueltigAb"></mat-datepicker-toggle>
                                            <mat-datepicker #gueltigAb></mat-datepicker>
                                        </div>
                                        <div class="col-md-4">
                                            <input class="dv-mat-datepicker" type="text"
                                                   [name]="fiStammdaten.ferienname + '_gueltigBis'" [id]="fiStammdaten.ferienname + '_gueltigBis'"
                                                   [(ngModel)]="fiStammdaten.ersterZeitraum.gueltigkeit.gueltigBis"
                                                   [matDatepicker]="gueltigBis"
                                                   [placeholder]="'DATE_PLACEHOLDER' | translate"
                                                   [required]="isDatumBisRequired(fiStammdaten.ersterZeitraum, fiStammdaten)">
                                            <mat-datepicker-toggle matSuffix
                                                                   [for]="gueltigBis"></mat-datepicker-toggle>
                                            <mat-datepicker #gueltigBis></mat-datepicker>
                                        </div>
                                        <div class="col-md-4">
                                            <input class="dv-mat-datepicker" type="text"
                                                   [name]="fiStammdaten.ferienname + '_anmeldeschluss'" [id]="fiStammdaten.ferienname + '_anmeldeschluss'"
                                                   [(ngModel)]="fiStammdaten.anmeldeschluss"
                                                   [matDatepicker]="anmeldeschluss"
                                                   [placeholder]="'DATE_PLACEHOLDER' | translate"
                                                   [required]="isAnmeldeschlussRequired(fiStammdaten)">
                                            <mat-datepicker-toggle matSuffix
                                                                   [for]="anmeldeschluss"></mat-datepicker-toggle>
                                            <mat-datepicker #anmeldeschluss></mat-datepicker>
                                        </div>
                                    </div>

                                    <div class="row zeitabschnitt"
                                         *ngFor="let zeitraum of fiStammdaten.zeitraumList">
                                        <div class="col-md-4">
                                            <input class="dv-mat-datepicker" type="text"
                                                   [name]="zeitraum + '_gueltigAb'"
                                                   [id]="zeitraum + '_gueltigAb'"
                                                   [(ngModel)]="zeitraum.gueltigkeit.gueltigAb"
                                                   [matDatepicker]="zeitraumGueltigAb"
                                                   [placeholder]="'DATE_PLACEHOLDER' | translate"
                                                   [required]="isDatumAbRequired(zeitraum, fiStammdaten)">
                                            <mat-datepicker-toggle matSuffix
                                                                   [for]="zeitraumGueltigAb"></mat-datepicker-toggle>
                                            <mat-datepicker #zeitraumGueltigAb></mat-datepicker>
                                        </div>
                                        <div class="col-md-4">
                                            <input class="dv-mat-datepicker" type="text"
                                                   [name]="zeitraum + '_gueltigBis'"
                                                   [id]="zeitraum + '_gueltigBis'"
                                                   [(ngModel)]="zeitraum.gueltigkeit.gueltigBis"
                                                   [matDatepicker]="zeitraumGueltigBis"
                                                   [placeholder]="'DATE_PLACEHOLDER' | translate"
                                                   [required]="isDatumBisRequired(zeitraum, fiStammdaten)">
                                            <mat-datepicker-toggle matSuffix
                                                                   [for]="zeitraumGueltigBis"></mat-datepicker-toggle>
                                            <mat-datepicker #zeitraumGueltigBis></mat-datepicker>
                                        </div>
                                        <div class="col-md-1 absolute-height">
                                            <a (click)="removeFerieninselZeitraum(fiStammdaten, zeitraum);"
                                               class="pointer remove-ferieninsel"
                                               title="{{'FERIENINSELZEITRAUM_DELETE' | translate}}"
                                               [attr.aria-label]="'FERIENINSELZEITRAUM_DELETE'|translate">
                                                <i class="fa fa-lg fa-trash-o"
                                                   [attr.aria-label]="'FERIENINSELZEITRAUM_DELETE' | translate"></i>
                                            </a>
                                        </div>

                                    </div>

                                    <div class="row">
                                        <div class="col-md-4">
                                            <a class="add-zeitraum pointer"
                                                    (click)="addFerieninselZeitraum(fiStammdaten)"
                                                    title="{{'FERIENINSELZEITRAUM_ADD' | translate}}"
                                                    [attr.aria-label]="'FERIENINSELZEITRAUM_ADD'|translate">
                                                <i class="fa fa-plus-circle"></i>
                                                {{'FERIENINSELZEITRAUM_ADD'|translate}}
                                            </a>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </tab-body>
                </dv-accordion-tab>
            </ng-container>
        </dv-accordion>
    </div>
</div>
