<!--
  ~ Copyright (C) 2020 DV Bern AG, Switzerland
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program. If not, see <https://www.gnu.org/licenses/>.
  -->

<div class="tagesschule-angaben">
    <h1 class="access-for-all-title">{{'LASTENAUSGLEICH_TAGESSCHULEN_ANGABEN_TAGESSCHULEN' | translate}}</h1>
    <div class="row view-title">
        <div class="col-md-12">
            <h2 translate>LASTENAUSGLEICH_TAGESSCHULEN_ANGABEN_TAGESSCHULEN</h2>
            <hr class="header"/>
        </div>
    </div>

    <div class="well well-with-button" *ngIf="angabenAusKibon && (canSeeDurchKibonAusfuellen | async)">
        <span translate>LATS_AUTOMATISCHE_BERECHNUNGEN_HINT</span>
        <!--        <div class="flex-whitespace-item"></div>-->
        <button class="dv-btn cancel-button" (click)="fillOutCalculationsFromKiBon()">
            {{'LATS_DURCH_KIBON_AUSFUELLEN' | translate}}
        </button>
    </div>

    <form *ngIf="form" [formGroup]="form" class="tagesschule-angaben-wrapper" (ngSubmit)="onFormSubmit()">

        <div class="max-width-container-750">

            <h3 translate class="uppercase">ALLGEMEINE_ANGABEN</h3>

            <dv-input-container-x>
                <label required
                       [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('isLehrbetrieb').errors}"
                       id="isLehrbetrieb-radio-group">
                    {{'LATS_IST_LEHRBETRIEB' | translate:{periode: gesuchsPeriode?.gesuchsperiodeString} }}
                </label>
                <dv-radio-container-x>

                    <mat-radio-group
                        aria-labelledby="isLehrbetrieb-radio-group"
                        class=""
                        name="isLehrbetrieb"
                        horizontal
                        [disabled]="form.get('isLehrbetrieb').disabled"
                        formControlName="isLehrbetrieb">
                        <mat-radio-button [value]="true">{{'LABEL_JA' | translate }}</mat-radio-button>
                        <mat-radio-button [value]="false">{{'LABEL_NEIN' | translate }}</mat-radio-button>
                    </mat-radio-group>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.isLehrbetrieb"
                        [korrektur]="form.get('isLehrbetrieb').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                    </dv-bisher-x>
                </dv-radio-container-x>
            </dv-input-container-x>

        </div>

        <mat-divider></mat-divider>

        <div class="max-width-container-750">

            <h3 class="uppercase">{{'LATS_QUANTITATIVE_ANGABEN' | translate}}</h3>

            <dv-input-container-x>
            <label [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('anzahlEingeschriebeneKinder').errors}">
                {{'LATS_ANZAHL_EINGESCHRIEBENE_KINDER' | translate: {datum: (stichtag | async)} }}
                <dv-tooltip [text]="'LATS_ANZAHL_EINGESCHRIEBENE_KINDER_INFO' | translate"></dv-tooltip>
            </label>

            <mat-form-field floatLabel="always">
                <input matInput
                       formControlName="anzahlEingeschriebeneKinder"
                       class="form-control dv-input"/>
                <mat-error *ngIf="formFreigebenTriggered && form.get('anzahlEingeschriebeneKinder').errors?.required"
                           translate>ERROR_REQUIRED
                </mat-error>
                <mat-error *ngIf="form.get('anzahlEingeschriebeneKinder').errors?.isNotPositiveInteger"
                           translate>ERROR_POSITIVE_NUMBER
                </mat-error>
                <dv-bisher-x
                    [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.anzahlEingeschriebeneKinder"
                    [korrektur]="form.get('anzahlEingeschriebeneKinder').value"
                    [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                    [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                </dv-bisher-x>
            </mat-form-field>
        </dv-input-container-x>

                <dv-input-container-x>
                    <label
                        [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderKindergarten').errors}">
                        {{'LATS_DAVON_KINDERGARTEN' | translate}}
                    </label>
                    <mat-form-field floatLabel="always">
                        <input matInput
                               formControlName="anzahlEingeschriebeneKinderKindergarten"
                               class="form-control dv-input"/>
                        <mat-error
                            *ngIf="formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderKindergarten').errors?.required"
                            translate>ERROR_REQUIRED
                        </mat-error>
                        <mat-error
                            *ngIf="form.get('anzahlEingeschriebeneKinderKindergarten').errors?.isNotPositiveInteger"
                            translate>ERROR_POSITIVE_NUMBER
                        </mat-error>
                        <dv-bisher-x
                            [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.anzahlEingeschriebeneKinderKindergarten"
                            [korrektur]="form.get('anzahlEingeschriebeneKinderKindergarten').value"
                            [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                            [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                        </dv-bisher-x>
                    </mat-form-field>
                </dv-input-container-x>

                <dv-input-container-x>
                    <label
                        [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderPrimarstufe').errors}">
                        {{'LATS_DAVON_PRIMARSTUFE' | translate}}
                    </label>
                    <mat-form-field floatLabel="always">
                        <input matInput
                               formControlName="anzahlEingeschriebeneKinderPrimarstufe"
                               class="form-control dv-input"/>
                        <mat-error
                            *ngIf="formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderPrimarstufe').errors?.required"
                            translate>ERROR_REQUIRED
                        </mat-error>
                        <mat-error
                            *ngIf="form.get('anzahlEingeschriebeneKinderPrimarstufe').errors?.isNotPositiveInteger"
                            translate>ERROR_POSITIVE_NUMBER
                        </mat-error>
                        <dv-bisher-x
                            [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.anzahlEingeschriebeneKinderPrimarstufe"
                            [korrektur]="form.get('anzahlEingeschriebeneKinderPrimarstufe').value"
                            [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                            [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                        </dv-bisher-x>
                    </mat-form-field>
                </dv-input-container-x>

        <dv-input-container-x>
            <label [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderSekundarstufe').errors}">
                {{'LATS_DAVON_SEKUNDARSTUFE' | translate}}
            </label>
            <mat-form-field floatLabel="always">
                <input matInput
                       formControlName="anzahlEingeschriebeneKinderSekundarstufe"
                       class="form-control dv-input"/>
                <mat-error *ngIf="formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderSekundarstufe').errors?.required"
                           translate>ERROR_REQUIRED
                </mat-error>
                <mat-error *ngIf="form.get('anzahlEingeschriebeneKinderSekundarstufe').errors?.isNotPositiveInteger"
                           translate>ERROR_POSITIVE_NUMBER
                </mat-error>
            </mat-form-field>
        </dv-input-container-x>

        <div class="well well-status-warten" *ngIf="abweichungenAnzahlKinder !== 0">
            <i class="fa fa-exclamation" aria-hidden="true"></i>
            <span>
                <span translate>LATS_ABWEICHUNGEN_ANZAHL_KINDER</span>
                <span *ngIf="autoFilled && anzahlEingeschriebeneKinder?.vorschulalter == 1">
                    {{'LATS_ABWEICHUNGEN_ANZAHL_KINDER_VORSCHULALTER_HINT' | translate }}
                </span>
                <span *ngIf="autoFilled && anzahlEingeschriebeneKinder?.vorschulalter > 1">
                    {{'LATS_ABWEICHUNGEN_ANZAHL_KINDER_VORSCHULALTER_HINT_MEHRZAHL' | translate:{numberAntraege: anzahlEingeschriebeneKinder?.vorschulalter} }}
                </span>
            </span>
        </div>

            <dv-input-container-x>
                <label
                    [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderMitBesonderenBeduerfnissen').errors}">
                    {{'LATS_ANZAHL_KINDER_BESONDERE_ANFORDERUNGEN' | translate}}
                    <dv-tooltip [text]="'LATS_ANZAHL_KINDER_BESONDERE_ANFORDERUNGEN_INFO' | translate"></dv-tooltip>
                </label>
                <mat-form-field floatLabel="always">
                    <input matInput
                           formControlName="anzahlEingeschriebeneKinderMitBesonderenBeduerfnissen"
                           class="form-control dv-input"/>
                    <mat-error
                        *ngIf="formFreigebenTriggered && form.get('anzahlEingeschriebeneKinderMitBesonderenBeduerfnissen').errors?.required"
                        translate>ERROR_REQUIRED
                    </mat-error>
                    <mat-error
                        *ngIf="form.get('anzahlEingeschriebeneKinderMitBesonderenBeduerfnissen').errors?.isNotPositiveInteger"
                        translate>ERROR_POSITIVE_NUMBER
                    </mat-error>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.anzahlEingeschriebeneKinderMitBesonderenBeduerfnissen"
                        [korrektur]="form.get('anzahlEingeschriebeneKinderMitBesonderenBeduerfnissen').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                    </dv-bisher-x>
                </mat-form-field>
            </dv-input-container-x>

        <mat-divider class="margin-bottom-20"></mat-divider>

        <div class="max-width-container-750">

                <dv-input-container-x>
            <label>{{'LATS_IN_BETREUUNG_EINLEITUNG' | translate:{datum: stichtag | async} }}</label>
        </dv-input-container-x>

        <dv-input-container-x>
            <label [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('durchschnittKinderProTagFruehbetreuung').errors}">
                {{'LATS_IN_FRUEH_BETREUUNG' | translate}}
            </label>
            <mat-form-field floatLabel="always">
                <input matInput
                       formControlName="durchschnittKinderProTagFruehbetreuung"
                       class="form-control dv-input"/>
                <mat-error *ngIf="formFreigebenTriggered && form.get('durchschnittKinderProTagFruehbetreuung').errors?.required"
                           translate>ERROR_REQUIRED
                </mat-error>
                <mat-error *ngIf="form.get('durchschnittKinderProTagFruehbetreuung').errors?.isNotPositiveInteger"
                           translate>ERROR_POSITIVE_NUMBER
                </mat-error>
                <dv-bisher-x
                    [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.durchschnittKinderProTagFruehbetreuung"
                    [korrektur]="form.get('durchschnittKinderProTagFruehbetreuung').value"
                    [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                    [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                </dv-bisher-x>
            </mat-form-field>
        </dv-input-container-x>

        <dv-input-container-x>
            <label [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('durchschnittKinderProTagMittag').errors}">
                {{'LATS_ANZAHL_IN_MITTAGSBETREUUNG' | translate}}
            </label>

            <mat-form-field floatLabel="always">
                <input matInput
                       formControlName="durchschnittKinderProTagMittag"
                       class="form-control dv-input"/>
                <mat-error *ngIf="formFreigebenTriggered && form.get('durchschnittKinderProTagMittag').errors?.required"
                           translate>ERROR_REQUIRED
                </mat-error>
                <mat-error *ngIf="form.get('durchschnittKinderProTagMittag').errors?.isNotPositiveInteger"
                           translate>ERROR_POSITIVE_NUMBER
                </mat-error>
                <dv-bisher-x
                    [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.durchschnittKinderProTagMittag"
                    [korrektur]="form.get('durchschnittKinderProTagMittag').value"
                    [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                    [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                </dv-bisher-x>
            </mat-form-field>
        </dv-input-container-x>

        <dv-input-container-x>
            <label [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('durchschnittKinderProTagNachmittag1').errors}">
                {{'LATS_ANZAHL_NACHMITTAG_1' | translate}}
            </label>

            <mat-form-field floatLabel="always">
                <input matInput
                       formControlName="durchschnittKinderProTagNachmittag1"
                       class="form-control dv-input"/>
                <mat-error *ngIf="formFreigebenTriggered && form.get('durchschnittKinderProTagNachmittag1').errors?.required"
                           translate>ERROR_REQUIRED
                </mat-error>
                <mat-error *ngIf="form.get('durchschnittKinderProTagNachmittag1').errors?.isNotPositiveInteger"
                           translate>ERROR_POSITIVE_NUMBER
                </mat-error>
                <dv-bisher-x
                    [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.durchschnittKinderProTagNachmittag1"
                    [korrektur]="form.get('durchschnittKinderProTagNachmittag1').value"
                    [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                    [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                </dv-bisher-x>
            </mat-form-field>
        </dv-input-container-x>

        <dv-input-container-x>
            <label [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('durchschnittKinderProTagNachmittag2').errors}">
                {{'LATS_ANZAHL_NACHMITTAG_2' | translate}}
            </label>

            <mat-form-field floatLabel="always">
                <input matInput
                       formControlName="durchschnittKinderProTagNachmittag2"
                       class="form-control dv-input"/>
                <mat-error *ngIf="formFreigebenTriggered && form.get('durchschnittKinderProTagNachmittag2').errors?.required"
                           translate>ERROR_REQUIRED
                </mat-error>
                <mat-error *ngIf="form.get('durchschnittKinderProTagNachmittag2').errors?.isNotPositiveInteger"
                           translate>ERROR_POSITIVE_NUMBER
                </mat-error>
                <dv-bisher-x
                    [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.durchschnittKinderProTagNachmittag2"
                    [korrektur]="form.get('durchschnittKinderProTagNachmittag2').value"
                    [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                    [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                </dv-bisher-x>
            </mat-form-field>
        </dv-input-container-x>

                <dv-input-container-x>
                    <label
                        [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('betreuungsstundenEinschliesslichBesondereBeduerfnisse').errors}">
                        {{'LATS_BETREUUNGSSTUNDEN_EINSCHLIESSLICH_BESONDERE_BEDUERFNISSE' | translate:{schuljahr: gesuchsPeriode?.gesuchsperiodeString} }}
                        <dv-tooltip
                            [text]="'LATS_BETREUUNGSSTUNDEN_EINSCHLIESSLICH_BESONDERE_BEDUERFNISSE_INFO' | translate:{year: gemeindeAntragContainer?.gesuchsperiode?.gesuchsperiodeString}"></dv-tooltip>
                    </label>
                    <mat-form-field floatLabel="always">
                        <input matInput
                               formControlName="betreuungsstundenEinschliesslichBesondereBeduerfnisse"
                               class="form-control dv-input"/>
                        <mat-error
                            *ngIf="formFreigebenTriggered && form.get('betreuungsstundenEinschliesslichBesondereBeduerfnisse').errors?.required"
                            translate>ERROR_REQUIRED
                        </mat-error>
                        <mat-error
                            *ngIf="form.get('betreuungsstundenEinschliesslichBesondereBeduerfnisse').errors?.isNotPositiveInteger"
                            translate>ERROR_POSITIVE_NUMBER
                        </mat-error>
                        <dv-bisher-x
                            [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.betreuungsstundenEinschliesslichBesondereBeduerfnisse"
                            [korrektur]="form.get('betreuungsstundenEinschliesslichBesondereBeduerfnisse').value"
                            [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                            [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                        </dv-bisher-x>
                    </mat-form-field>
                </dv-input-container-x>

            </div>

        </div>

        <mat-divider></mat-divider>

        <div class="max-width-container-750">

            <h3 translate class="uppercase">QUALITATIVE_VORGABEN_TAGESSCHULVERORDNUNG</h3>

            <dv-input-container-x>
                <label required
                       [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('schuleAufBasisOrganisatorischesKonzept').errors}"
                       id="schuleAufBasisOrganisatorischesKonzept-radio-group">
                    {{'LATS_AUF_BASIS_ORG_KONZEPT' | translate}}
                </label>
                <dv-radio-container-x>

                    <mat-radio-group
                        aria-labelledby="schuleAufBasisOrganisatorischesKonzept-radio-group"
                        class=""
                        name="schuleAufBasisOrganisatorischesKonzept"
                        horizontal
                        [disabled]="form.get('schuleAufBasisOrganisatorischesKonzept').disabled"
                        formControlName="schuleAufBasisOrganisatorischesKonzept">
                        <mat-radio-button [value]="true">{{'LABEL_JA' | translate }}</mat-radio-button>
                        <mat-radio-button [value]="false">{{'LABEL_NEIN' | translate }}</mat-radio-button>
                    </mat-radio-group>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.schuleAufBasisOrganisatorischesKonzept"
                        [korrektur]="form.get('schuleAufBasisOrganisatorischesKonzept').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                    </dv-bisher-x>
                </dv-radio-container-x>
            </dv-input-container-x>

            <dv-input-container-x>
                <label required
                       [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('schuleAufBasisPaedagogischesKonzept').errors}"
                       id="schuleAufBasisPaedagogischesKonzept-radio-group">
                    {{'LATS_AUF_BASIS_PAEDAGOGISCH_KONZEPT' | translate}}
                </label>
                <dv-radio-container-x>

                    <mat-radio-group
                        aria-labelledby="schuleAufBasisPaedagogischesKonzept-radio-group"
                        class=""
                        name="schuleAufBasisPaedagogischesKonzept"
                        horizontal
                        [disabled]="form.get('schuleAufBasisPaedagogischesKonzept').disabled"
                        formControlName="schuleAufBasisPaedagogischesKonzept">
                        <mat-radio-button [value]="true">{{'LABEL_JA' | translate }}</mat-radio-button>
                        <mat-radio-button [value]="false">{{'LABEL_NEIN' | translate }}</mat-radio-button>
                    </mat-radio-group>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.schuleAufBasisPaedagogischesKonzept"
                        [korrektur]="form.get('schuleAufBasisPaedagogischesKonzept').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                    </dv-bisher-x>
                </dv-radio-container-x>
            </dv-input-container-x>

            <dv-input-container-x>
                <label required
                       [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('raeumlicheVoraussetzungenEingehalten').errors}"
                       id="raeumlicheVoraussetzungenEingehalten-radio-group">
                    {{'LATS_RAEULICHE_VORAUSSETZUNGEN_EINGEHALTEN' | translate}}
                </label>
                <dv-radio-container-x>

                    <mat-radio-group
                        aria-labelledby="raeumlicheVoraussetzungenEingehalten-radio-group"
                        class=""
                        name="raeumlicheVoraussetzungenEingehalten"
                        horizontal
                        [disabled]="form.get('raeumlicheVoraussetzungenEingehalten').disabled"
                        formControlName="raeumlicheVoraussetzungenEingehalten">
                        <mat-radio-button [value]="true">{{'LABEL_JA' | translate }}</mat-radio-button>
                        <mat-radio-button [value]="false">{{'LABEL_NEIN' | translate }}</mat-radio-button>
                    </mat-radio-group>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.raeumlicheVoraussetzungenEingehalten"
                        [korrektur]="form.get('raeumlicheVoraussetzungenEingehalten').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                    </dv-bisher-x>
                </dv-radio-container-x>
            </dv-input-container-x>

            <dv-input-container-x>
                <label required
                       [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('betreuungsverhaeltnisEingehalten').errors}"
                       id="betreuungsverhaeltnisEingehalten-radio-group">
                    {{'LATS_BETREUUNGSVERHAELTNIS_EINGEHALTEN' | translate}}
                </label>
                <dv-radio-container-x>

                    <mat-radio-group
                        aria-labelledby="betreuungsverhaeltnisEingehalten-radio-group"
                        class=""
                        name="betreuungsverhaeltnisEingehalten"
                        horizontal
                        [disabled]="form.get('betreuungsverhaeltnisEingehalten').disabled"
                        formControlName="betreuungsverhaeltnisEingehalten">
                        <mat-radio-button [value]="true">{{'LABEL_JA' | translate }}</mat-radio-button>
                        <mat-radio-button [value]="false">{{'LABEL_NEIN' | translate }}</mat-radio-button>
                    </mat-radio-group>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.betreuungsverhaeltnisEingehalten"
                        [korrektur]="form.get('betreuungsverhaeltnisEingehalten').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                    </dv-bisher-x>
                </dv-radio-container-x>
            </dv-input-container-x>

            <dv-input-container-x>
                <label required
                       [ngClass]="{'label-required-error': formFreigebenTriggered && form.get('ernaehrungsGrundsaetzeEingehalten').errors}"
                       id="ernaehrungsGrundsaetzeEingehalten-radio-group">
                    {{'LATS_ERNAEHRUNGS_GRUNDSAETZE_EINGEHALTEN' | translate}}
                </label>
                <dv-radio-container-x>

                    <mat-radio-group
                        aria-labelledby="ernaehrungsGrundsaetzeEingehalten-radio-group"
                        class=""
                        name="ernaehrungsGrundsaetzeEingehalten"
                        horizontal
                        [disabled]="form.get('ernaehrungsGrundsaetzeEingehalten').disabled"
                        formControlName="ernaehrungsGrundsaetzeEingehalten">
                        <mat-radio-button [value]="true">{{'LABEL_JA' | translate }}</mat-radio-button>
                        <mat-radio-button [value]="false">{{'LABEL_NEIN' | translate }}</mat-radio-button>
                    </mat-radio-group>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.ernaehrungsGrundsaetzeEingehalten"
                        [korrektur]="form.get('ernaehrungsGrundsaetzeEingehalten').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL_INSTITUTION' | translate">
                    </dv-bisher-x>
                </dv-radio-container-x>
            </dv-input-container-x>

        </div>
        <mat-divider></mat-divider>
        <div class="max-width-container-750">

            <h3 class="uppercase">{{'LATS_ANGABEN_GEMEINDE_BEMERKUNGEN' | translate}}</h3>

            <dv-input-container-x [verticalAlign]="true">
                <mat-form-field floatLabel="always" class="no-margin-left">
                    <textarea matInput
                              formControlName="bemerkungen"
                              class="form-control dv-input"></textarea>
                    <dv-bisher-x
                        [deklaration]="latsAngabenInstitutionContainer?.angabenDeklaration?.bemerkungen"
                        [korrektur]="form.get('bemerkungen').value"
                        [showBisher]="latsAngabenInstitutionContainer?.isAtLeastInBearbeitungGemeinde()"
                        [specificBisherLabel]="'LATS_BISHER_LABEL' | translate">
                    </dv-bisher-x>
                </mat-form-field>
            </dv-input-container-x>

        </div>

        <div class="row" *ngIf="canSeeFalscheAngaben | async">
            <div class="col-md-12">
                <a class="pointer-cursor" (click)="onFalscheAngaben()" translate>FALSCHE_ANGABEN</a>
            </div>
        </div>

        <div class="actions">
            <dv-loading-button
                class="uppercase"
                *ngIf="canSeeFreigeben | async"
                type="button"
                [buttonDisabled]="actionButtonsDisabled()"
                (buttonClick)="onFreigeben()">
                <span translate>FREIGEBEN</span>
            </dv-loading-button>

            <dv-loading-button
                class="uppercase"
                *ngIf="canSeeAbschliessen | async"
                type="button"
                [buttonDisabled]="actionButtonsDisabled()"
                (buttonClick)="onGeprueft()">
                <span translate>GEPRUEFT</span>
            </dv-loading-button>

            <button class="dv-btn cancel-button uppercase"
                    type="button"
                    *ngIf="canSeeSave | async"
                    [disabled]="actionButtonsDisabled()"
                    (click)="onFormSubmit()">
                <span translate>SAVE</span>
            </button>

            <button class="dv-btn cancel-button margin-left-5 uppercase"
                    type="button"
                    *ngIf="canSeeSave | async"
                    (click)="navigateBack($event)">
                <span translate>CANCEL</span>
            </button>
        </div>

    </form>
</div>
